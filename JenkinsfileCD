node {
  stage('SCM') {
    checkout scm
  }
  // stage('Install and Build') { 
  //   nodejs(nodeJSInstallationName: 'NodeJS') {
  //     sh 'npm install'
  //     sh 'ng build --configuration=production'
  //   }
  // }
  stage('Deploy') { 
      pwsh '''
        ssh remote_jenkins@nginx && \
        ls -la && \
        cd ./DeployWeb && \
        date_backup=backup-$(date +%d)-$(date +%m)-$(date +%Y)-$(date +%H):$(date +%M):$(date +%S) && \
        mkdir $date_backup && \
        mv ./www/* ./backup/$date_backup
      '''
      sh 'scp -r /var/jenkins_home/workspace/MTM-Web-CD/dist/DeyApps/* remote_jenkins@nginx:./DeployWeb/www'
  }
  post {
        always {
            echo 'This will always run'
        }
        success {
            echo 'This will run only if successful'
        }
        failure {
            echo 'This will run only if failed'
        }
        unstable {
            echo 'This will run only if the run was marked as unstable'
        }
        changed {
            echo 'This will run only if the state of the Pipeline has changed'
            echo 'For example, if the Pipeline was previously failing but is now successful'
        }
    }
}
